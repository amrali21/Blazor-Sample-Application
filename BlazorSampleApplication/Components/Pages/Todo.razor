@using BlazorSampleApplication.Models;

@page "/todo"

@rendermode InteractiveServer

<h3>Todo (@todos.Count(todo => !todo.IsDone))</h3>
<ul>
    @foreach (var todo in todos)
    {
        <li>
            <input type="checkbox" @bind="todo.IsDone" />
            @todo.Title
            <button @onclick="() => Edit(todo)">Edit</button>
            <button @onclick="() => Delete(todo)">Delete</button>
        </li>
    }
</ul>
<input @bind="newTodo" />

@if (!editMode)
{
    <button @onclick="AddTodo">Add todo</button>
}
else
{
    <button @onclick="SaveEdit">Edit</button>
    <button @onclick="()=> {editMode = false;}">Cancel</button>
}

@code {
    private List<TodoItem> todos = new();
    string newTodo = "";

    bool editMode = false;
    TodoItem itemToEdit = null;

    void AddTodo()
    {
        if (!string.IsNullOrWhiteSpace(newTodo))
        {
            todos.Add(new TodoItem { Title = newTodo });
            newTodo = string.Empty;
        }
    }

    void SaveEdit()
    {
        itemToEdit.Title = newTodo;
        newTodo = "";
        editMode = false;
    }

    void Edit(TodoItem item)
    {
        newTodo = item.Title;
        itemToEdit = item;
        editMode = true;
    }

    void Delete(TodoItem todo)
    {
        
        todos.Remove(todo);
    }
}
